<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pet Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
:root {
  --bg: #121212;
  --surface: #1f1f1f;
  --card-bg: #1e1e1e;
  --text: #e0e0e0;
  --accent: #4f96ff;
  --border: #333;
  --shadow: rgba(0, 0, 0, 0.5);
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: 'Lexend', sans-serif;
  background: var(--bg);
  color: var(--text);
}

.container {
  max-width: 1200px;
  margin: auto;
  padding: 2rem 1rem;
}

header {
  margin-bottom: 1rem;
}

header h1 {
  margin: 0 0 0.5rem;
  font-size: clamp(1.5rem, 6vw, 2rem);
  color: var(--accent);
}

.controls-wrapper {
  background: var(--surface);
  border-radius: 12px;
  box-shadow: 0 4px 12px var(--shadow);
  padding: 0.8rem 1rem !important;
  
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem !important;
  margin-bottom: 1rem;
}

.search-input {
  flex: 0 1 auto;
  width: clamp(350px, 20vw, 300px);
  
padding: 0.4rem 0.6rem !important;
  padding-left: 2rem !important;


  border: 1px solid var(--border);
  border-radius: 8px;

  background:
    var(--bg)
    url('https://images.hixand.xyz/search.png')
    no-repeat 0.75rem center;
  background-size: 1rem 1rem;

  color: var(--text);
  font-size: 1rem;
}

@media (max-width: 600px) {
  .search-input {
    flex: 1 1 auto;
    width: 100%;
    max-width: none;

    padding: 0.4rem 0.6rem;
    padding-left: 2rem;

    background-position: 0.6rem center;
    background-size: 0.9rem 0.9rem;

    font-size: 0.9rem;
  }
}



.search-input:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(134,156,252,0.3);
}

.toggle-btn-group {
  display: flex;
  gap: 1rem;
  margin-left: auto;
  flex-wrap: wrap;
}

.toggle-btn {
  flex: 0 0 auto;
 padding: 0.4rem 1rem !important;
 
 border: 1px solid var(--accent);
  background: var(--bg);
  color: var(--accent);
  border-radius: 8px;
  cursor: pointer;
  font-size: 1rem;
  font-weight: 600;
  transition: background 0.2s, color 0.2s;
  min-height: 44px;
}

.toggle-btn.active {
  background: var(--accent);
  color: var(--bg);
}

.category-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  justify-content: center;
  margin-bottom: 1rem;
}

.category-btn {
  flex: 0 0 auto;
  padding: 0.75rem 1.25rem;
  border: 1px solid var(--border);
  background: none;
  color: var(--text);
  font-size: 1.05rem;
  font-weight: 600;
  border-radius: 8px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 44px;
  transition: background 0.2s, border-color 0.2s;
}

.category-btn.active {
  background: var(--accent);
  border-color: var(--accent);
  color: var(--bg);
}

.sort-wrapper {
  margin-left: auto;
  position: relative;
}

.sort-select {
  display: none;
}

.custom-select {
  position: relative;
  width: 100%;
  max-width: 240px;
  user-select: none;
}

.custom-select-trigger {
  background: var(--surface);
  border: 1px solid var(--border);
  padding: 0.75rem 1rem;
  border-radius: 8px;
  font-weight: 600;
  font-size: 0.95rem;
  color: var(--text);
  display: flex;
  align-items: center;
  justify-content: space-between;
  cursor: pointer;
  box-shadow: inset 0 1px 2px rgba(0,0,0,0.5);
  transition: border-color 0.2s, box-shadow 0.2s;
}

.custom-select-trigger::after {
  content: "";
  border: 6px solid transparent;
  border-top-color: var(--text);
  margin-left: 0.5rem;
}

.custom-options {
  position: absolute;
  top: calc(100% + 0.25rem);
  left: 0;
  right: 0;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 8px;
  box-shadow: 0 4px 12px var(--shadow);
  opacity: 0;
  pointer-events: none;
  transform: translateY(-0.5rem);
  transition: opacity 0.2s, transform 0.2s;
  z-index: 10;
}

.custom-select.open .custom-options {
  opacity: 1;
  pointer-events: auto;
  transform: translateY(0);
}

.custom-option {
  display: block;
  padding: 0.75rem 1rem;
  font-size: 0.95rem;
  cursor: pointer;
  color: var(--text);
  transition: background 0.2s;
}

.custom-option:hover {
  background: rgba(134,156,252,0.1);
}

.custom-option.selected {
  color: var(--accent);
}

main {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
  gap: 0.75rem;
}

.card {
  position: relative;
  background: var(--card-bg);
  border-radius: 8px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  box-shadow: 0 2px 6px var(--shadow);
  transition: transform 0.2s, box-shadow 0.2s;
}

.card:hover {
  transform: translateY(-4px);
  box-shadow: 0 6px 18px var(--shadow);
}

.card .img-container {
  width: 100%;
  aspect-ratio: 5/4;    
  background: rgba(73, 73, 73, 0.2);
  padding: 0.25rem;
  margin-bottom: 0.5rem;

  display: flex;
  align-items: center;  
  justify-content: center;      
}

.card .img-container picture {
  display: flex;
  align-items: center;
  justify-content: center;
}

.card .img-container picture img {
  max-width: 80%;     
  max-height: 80%;
  object-fit: contain;         
  display: block;
  margin: auto;                 
}

.info {
  padding: 0.5rem;
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
}

.name-row {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.info h3 {
  margin: 0;
  font-size: clamp(0.85rem, 2.5vw, 1rem);
  color: var(--accent);
  font-weight: 600;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.demand-badge {
  position: absolute;
  bottom: 0.5rem;
  right: 0.75rem;
  color: #121212;
font-size: 0.75rem;  
  font-weight: 500;
  padding: 0.15rem 0.4rem;
    border-radius: 4px;
  white-space: nowrap;
}

.demand-badge.low    { background: #EF5350; }
.demand-badge.medium { background: #ffc32b; }
.demand-badge.high   { background: #8BC34A; }
.demand-badge.very-high { background: #e3abf1; }
.demand-badge.insane { background: #cc00ff; }

.info .stats-row {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin: 0.25rem 0;
}

.card .info .stats-row {
  position: relative;
  top: 0.25rem;     
}


.info .stat {
  display: flex;
  align-items: center;
  gap: 0.25rem;
  font-size: 0.75rem;
  color: var(--text);
}

.info .stat-icon {
  width: 12px;
  height: 12px;
}

.value-block {
  margin-top: 0.5rem;
  display: flex;
  flex-direction: column;
  gap: 0.1rem;
}

.value-number {
  font-size: 1.25rem;
  font-weight: 600;
  color: var(--text);
}

.value-label {
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.02em;
}

@media (max-width: 600px) {
  .controls-wrapper { flex-direction: column; gap: 0.5rem; }
  .toggle-btn-group { justify-content: space-between; }
  .category-buttons { flex-direction: column; gap: 0.5rem; }
  .sort-wrapper { margin-left: 0; width: 100%; }
  .custom-select { max-width: none; }
}

@media (max-width: 400px) {
  main { gap: 0.5rem; }
}

@media (max-width: 600px) {
  .container {
    padding: 1.5rem 0.5rem;
  }
  .controls-wrapper {
    padding: 1rem;
    gap: 0.5rem;
  }
  .search-input {
    font-size: 0.9rem;
    padding: 0.4rem 0.6rem;
  }
  .toggle-btn, .category-btn {
    padding: 0.6rem 1rem;
    font-size: 0.9rem;
    min-height: 40px;
  }
  .custom-select-trigger {
    padding: 0.6rem 0.8rem;
    font-size: 0.9rem;
  }
  main {
    gap: 0.5rem;
  }
}

@media (max-width: 400px) {
  main {
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 0.4rem;
  }
  .card {
    box-shadow: none;
    transition: none;
  }
  .img-container {
    padding: 0.125rem;
  }
  .info {
    padding: 0.25rem;
    gap: 0.1rem;
  }
  .info h3 {
    font-size: clamp(0.75rem, 3vw, 0.9rem);
  }
  .stat {
    font-size: 0.65rem;
  }
  .value-number {
    font-size: 1rem;
  }
  .value-label {
    font-size: 0.65rem;
  }
  .demand-badge {
    font-size: 0.75rem;
    padding: 0.15rem 0.4rem;
  }
}

@media (max-width: 600px) {
  .search-input {
    font-size: 0.9rem;
    padding: 0.4rem 0.6rem;
    padding-left: 2.2rem; 
  }
}
@media (max-width: 600px) {
  .controls-wrapper {
    flex-direction: row;    
    align-items: center;
    gap: 0.5rem;
  }
  .search-input {
    flex: 1;                 
    width: auto;            
    max-width: none;
  }
  .toggle-btn-group {
    margin-left: 0;         
  }
}
@media (max-width: 600px) {
  .search-input {
    padding: 0.8rem 0.6rem;
    padding-left: 2rem; 
    background-position: 0.6rem center;
    background-size: 0.9rem 0.9rem;
    
    font-size: 0.9rem;
  }
}

.card .img-container {
  aspect-ratio: 16/9 !important;    
  margin-bottom: 0.3rem !important;
  padding: 0.2rem !important;    
}

.card .img-container {
  aspect-ratio: auto !important;
  height: 120px !important;
}

.card .info {
  padding: 0.3rem !important;
  gap: 0.15rem !important;
}
.card .info .stats-row {
  margin: 0.15rem 0 !important;
}
.card .info .value-block {
  position: relative;
  top: -0.25rem;   
  padding-left: 0.1rem; 
}

.card .info .value-number,
.card .info .value-label {
  display: inline-block;
  position: relative;
  left: 0.2rem;     
}
.card .info .stats-row {
  position: relative;
  left: 0.1rem; 
}

.demand-badge {
  position: absolute;   
  bottom: 0.5rem;      
  right: 0.75rem;   
}

.demand-badge::after {
  content: "Demand:";
  position: absolute;
  bottom: -1.2rem;  
  right: 0;          
  font-size: 0.6rem;
  color: var(--text);
  text-transform: uppercase;
  white-space: nowrap;
}
  .trend-block {
    display: flex;
    justify-content: center;
    padding: 0.5rem 0;
  }
.card {
  position: relative;
}

.trend-icon {
  position: absolute;
  right: 0.75rem;
  bottom: 2.25rem;      
  width: 20px;
  height: 20px;
  object-fit: contain;
}

  </style>
</head>
<body>
  <div class="container">
    <div class="controls-wrapper">
      <input id="search" class="search-input" type="text" placeholder="Search petsâ€¦" />
      <div class="toggle-btn-group">
        <button id="btnShiny" class="toggle-btn">Shiny</button>
        <button id="btnMythic" class="toggle-btn">Mythic</button>
      </div>
    </div>
    <div class="category-buttons">
      <button id="catAll" class="category-btn active">All</button>
      <button id="catSecret" class="category-btn">Secret</button>
      <button id="catLegendary" class="category-btn">Legendary</button>
      <button id="catRobux" class="category-btn">Robux</button>
      <div class="sort-wrapper">
        <select id="sort" class="sort-select">
          <option value="value-desc">Highest Value</option>
          <option value="value-asc">Lowest Value</option>
          <option value="demand-desc">Highest Demand</option>
          <option value="demand-asc">Lowest Demand</option>
          <option value="name-asc">Name Aâ€“Z</option>
          <option value="name-desc">Name Zâ€“A</option>
        </select>
        <div class="custom-select">
          <div class="custom-select-trigger">Highest Value</div>
          <div class="custom-options">
            <span class="custom-option selected" data-value="value-desc">Highest Value</span>
            <span class="custom-option" data-value="value-asc">Lowest Value</span>
            <span class="custom-option" data-value="demand-desc">Highest Demand</span>
            <span class="custom-option" data-value="demand-asc">Lowest Demand</span>
            <span class="custom-option" data-value="name-asc">Name Aâ€“Z</span>
            <span class="custom-option" data-value="name-desc">Name Zâ€“A</span>
          </div>
        </div>
      </div>
    </div>
    <main id="cards"></main>
  </div>

  <script>
  function debounce(fn, wait = 250) {
    let timer;
    return (...args) => {
      clearTimeout(timer);
      timer = setTimeout(() => fn(...args), wait);
    };
  }

  const endpoints = {
    info:  'https://values.hixand.xyz/petinfo.json',
    values:'https://values.hixand.xyz/pet-values.json'
  };
  let pets = [], activeCategory = 'All', showShiny = false, showMythic = false;

  document.addEventListener('DOMContentLoaded', () => {
    ['All','Secret','Legendary','Robux'].forEach(cat =>
      document.getElementById('cat'+cat).onclick = () => setCategory(cat)
    );
    ['Shiny','Mythic'].forEach(type =>
      document.getElementById('btn'+type).onclick = e => {
        if (type==='Shiny') showShiny = !showShiny;
        else             showMythic = !showMythic;
        e.target.classList.toggle('active');
        renderCards();
      }
    );
    document.getElementById('search')
            .addEventListener('input', debounce(renderCards, 300));
    document.getElementById('sort')
            .addEventListener('change', renderCards);

    const custom = document.querySelector('.custom-select');
    const trigger = custom.querySelector('.custom-select-trigger');
    const options = custom.querySelectorAll('.custom-option');
    trigger.addEventListener('click', () => custom.classList.toggle('open'));
    options.forEach(opt => opt.addEventListener('click', () => {
      custom.querySelector('.selected').classList.remove('selected');
      opt.classList.add('selected');
      trigger.textContent = opt.textContent;
      custom.classList.remove('open');
      renderCards();
    }));
    document.addEventListener('click', e => {
      if (!custom.contains(e.target)) custom.classList.remove('open');
    });

    loadData();
  });

  function setCategory(cat) {
    activeCategory = cat;
    document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
    document.getElementById('cat'+cat).classList.add('active');
    renderCards();
  }
  const trendIcons = {
    down:   'https://images.hixand.xyz/downwards.webp',
    stable: 'https://images.hixand.xyz/stable-trend.webp',
    up:     'https://images.hixand.xyz/upwards.webp',
  };
  async function loadData() {
    try {
      const [infoRes, valueRes] = await Promise.all([
        fetch(endpoints.info),
        fetch(endpoints.values)
      ]);
      const infoJson  = await infoRes.json(),
            valueJson = await valueRes.json();

      pets = [];
      infoJson.forEach(p => {
        const vData = valueJson.find(v => v.pet_name === p.pet_name) || {};
        p.variants.forEach(v => {
          const stats = (vData.variants || []).find(x => x.name === v.name) || {};
          pets.push({
      pet_name: p.pet_name,
      title:    p.title,
      variant:  v.name,
      image:    v.image,
      bubbles:  v.stats.base.bubbles,
      coins:    v.stats.base.coins,
      gems:     v.stats.base.gems,
      value:    Number(stats.value)  || 0,
      demand:   stats.demand         || 'Low',
      trend:    stats.trend          || 'stable',  
    });
        });
      });

      renderCards();
    } catch(err) {
      console.error('Failed to load data:', err);
    }
  }

  function renderCards() {
    const container = document.getElementById('cards');
    container.innerHTML = '';

    let filtered = pets.filter(p => {
      if (!showShiny && !showMythic) return true;
      if (showShiny && showMythic)   return p.variant === 'Shiny Mythic';
      return showShiny ? p.variant === 'Shiny'
                       : p.variant === 'Mythic';
    });

    if (activeCategory !== 'All') {
      filtered = filtered.filter(p => p.title === activeCategory);
    }

    const q = document.getElementById('search').value.toLowerCase();
    if (q) filtered = filtered.filter(p =>
      p.pet_name.toLowerCase().includes(q)
    );

    const sv = document.querySelector('.custom-option.selected').dataset.value;
    const demandOrder = ['Low','Medium','High','Very High','Insane'];
    filtered.sort((a,b) => {
      switch (sv) {
        case 'value-desc':  return b.value - a.value;
        case 'value-asc':   return a.value - b.value;
        case 'demand-desc':
          return demandOrder.indexOf(b.demand)
               - demandOrder.indexOf(a.demand);
        case 'demand-asc':
          return demandOrder.indexOf(a.demand)
               - demandOrder.indexOf(b.demand);
        case 'name-asc':    return a.pet_name.localeCompare(b.pet_name);
        case 'name-desc':   return b.pet_name.localeCompare(a.pet_name);
        default: return 0;
      }
    });

    filtered.forEach(p => {
const bCount = Math.floor(p.bubbles),
      cCount = Math.floor(p.coins),
      gCount = Math.floor(p.gems),
      level  = p.demand;

const cls    = level
                   .toLowerCase()
                   .replace(/\s+/g, '-');
      const gemHTML = gCount > 0
        ? `<div class="stat">
             <img src="https://images.hixand.xyz/gems.webp"
                  class="stat-icon" alt="Gems">${gCount}
           </div>`
        : '';

const card = document.createElement('div');
  card.className = 'card';
  card.innerHTML = `
    <div class="img-container">
      <picture>
        <source type="image/webp" srcset="${p.image.replace(/\.\w+$/,'.webp')}">
        <img loading="lazy" src="${p.image}" alt="${p.pet_name}">
      </picture>
    </div>
    <div class="info">
      <div class="name-row">
        <h3>${p.pet_name}</h3>
      </div>
      <div class="stats-row">
        <div class="stat">
          <img src="https://images.hixand.xyz/bubblegum.webp" class="stat-icon" alt="Bubbles">${bCount}
        </div>
        <div class="stat">
          <img src="https://images.hixand.xyz/coins.webp" class="stat-icon" alt="Coins">${cCount}
        </div>
        ${gemHTML}
      </div>
      <hr style="border:1px solid var(--border);margin:0.5rem 0;">
      <div class="value-block">
        <div class="value-number">${p.value}</div>
        <div class="value-label">Value</div>
      </div>
      <span class="demand-badge ${cls}">${level}</span>
    </div>
    <img
      src="${trendIcons[p.trend.toLowerCase()]}"
      alt="${p.trend} trend"
      class="trend-icon"
    />
  `;
  container.appendChild(card);
});
  }
</script>

</body>
</html>
